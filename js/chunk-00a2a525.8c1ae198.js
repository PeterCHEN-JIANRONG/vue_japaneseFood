(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00a2a525"],{1276:function(e,t,n){"use strict";var o=n("2ba4"),a=n("c65b"),c=n("e330"),l=n("d784"),i=n("44e7"),r=n("825a"),d=n("1d80"),s=n("4840"),u=n("8aa5"),p=n("50c4"),b=n("577e"),m=n("dc4a"),h=n("4dae"),j=n("14c3"),O=n("9263"),f=n("9f7f"),g=n("d039"),v=f.UNSUPPORTED_Y,N=4294967295,E=Math.min,V=[].push,C=c(/./.exec),y=c(V),k=c("".slice),x=!g((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));l("split",(function(e,t,n){var c;return c="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var c=b(d(this)),l=void 0===n?N:n>>>0;if(0===l)return[];if(void 0===e)return[c];if(!i(e))return a(t,c,e,l);var r,s,u,p=[],m=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),j=0,f=new RegExp(e.source,m+"g");while(r=a(O,f,c)){if(s=f.lastIndex,s>j&&(y(p,k(c,j,r.index)),r.length>1&&r.index<c.length&&o(V,p,h(r,1)),u=r[0].length,j=s,p.length>=l))break;f.lastIndex===r.index&&f.lastIndex++}return j===c.length?!u&&C(f,"")||y(p,""):y(p,k(c,j)),p.length>l?h(p,0,l):p}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:a(t,this,e,n)}:t,[function(t,n){var o=d(this),l=void 0==t?void 0:m(t,e);return l?a(l,t,o,n):a(c,b(o),t,n)},function(e,o){var a=r(this),l=b(e),i=n(c,a,l,o,c!==t);if(i.done)return i.value;var d=s(a,RegExp),m=a.unicode,h=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(v?"g":"y"),O=new d(v?"^(?:"+a.source+")":a,h),f=void 0===o?N:o>>>0;if(0===f)return[];if(0===l.length)return null===j(O,l)?[l]:[];var g=0,V=0,C=[];while(V<l.length){O.lastIndex=v?0:V;var x,M=j(O,v?k(l,V):l);if(null===M||(x=E(p(O.lastIndex+(v?V:0)),l.length))===g)V=u(l,V,m);else{if(y(C,k(l,g,V)),C.length===f)return C;for(var w=1;w<=M.length-1;w++)if(y(C,M[w]),C.length===f)return C;V=g=x}}return y(C,k(l,g)),C}]}),!x,v)},"1fe2":function(e,t,n){"use strict";n.r(t);n("99af");var o=n("7a23"),a={class:"container py-4"},c=Object(o["createElementVNode"])("h1",{class:"mb-4"},"優惠券",-1),l={class:"text-end mb-2"},i={class:"table mb-4"},r=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"名稱"),Object(o["createElementVNode"])("th",null,"折扣碼"),Object(o["createElementVNode"])("th",null,"折扣百分比"),Object(o["createElementVNode"])("th",null,"到期日"),Object(o["createElementVNode"])("th",null,"是否啟用"),Object(o["createElementVNode"])("th",null,"編輯")])],-1),d={key:0},s={key:0,class:"text-success"},u={key:1,class:"text-muted"},p={class:"btn-group"},b=["onClick","disabled"],m=["onClick","disabled"],h={class:"text-end"};function j(e,t,n,j,O,f){var g=Object(o["resolveComponent"])("Loading"),v=Object(o["resolveComponent"])("Pagination"),N=Object(o["resolveComponent"])("AdminCouponModal"),E=Object(o["resolveComponent"])("DelModal");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(g,{active:O.isLoading,"z-index":1060},null,8,["active"]),Object(o["createElementVNode"])("div",a,[c,Object(o["createElementVNode"])("div",l,[Object(o["createElementVNode"])("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=function(e){return f.openCouponModal(!0)})}," 建立新的優惠券 ")]),Object(o["createElementVNode"])("table",i,[r,Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(O.coupons,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:"".concat(n).concat(t.id),class:Object(o["normalizeClass"])({"text-secondary":!t.is_enabled})},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.title),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.code),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.percent)+"%",1),Object(o["createElementVNode"])("td",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$filters.date(t.due_date))+" ",1),t.due_date<new Date/1e3?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",d,"(已過期)")):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("td",null,[1===t.is_enabled?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",s,"啟用")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",u,"未啟用"))]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",p,[Object(o["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm",onClick:function(e){return f.openCouponModal(!1,t)},disabled:O.isLoadingItem===t.id}," 編輯 ",8,b),Object(o["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm",onClick:function(e){return f.openDelCouponModal(t)},disabled:O.isLoadingItem===t.id}," 刪除 ",8,m)])])],2)})),128))])]),Object(o["createElementVNode"])("div",h,"共 "+Object(o["toDisplayString"])(O.coupons.length)+" 個",1),Object(o["createVNode"])(v,{pagination:O.pagination,onGetProducts:f.getCoupons},null,8,["pagination","onGetProducts"])]),Object(o["createVNode"])(N,{ref:"couponModal",coupon:O.tempCoupon,isNew:O.isNew,onUpdateCoupon:f.updateCoupon},null,8,["coupon","isNew","onUpdateCoupon"]),Object(o["createVNode"])(E,{ref:"delModal",item:O.tempCoupon,title:"優惠券",content:"".concat(O.tempCoupon.title,"，折扣馬：").concat(O.tempCoupon.code),onDelItem:f.deleteCoupon},null,8,["item","content","onDelItem"])],64)}var O=n("5530"),f=n("ca8d"),g={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog",role:"document"},N={class:"modal-content"},E={class:"modal-header"},V={class:"modal-title",id:"exampleModalLabel"},C={key:0},y={key:1},k=Object(o["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),x={class:"modal-body"},M={class:"mb-3"},w=Object(o["createElementVNode"])("label",{for:"title"},"標題",-1),_={class:"mb-3"},B=Object(o["createElementVNode"])("label",{for:"coupon_code"},"優惠碼",-1),D={class:"mb-3"},S=Object(o["createElementVNode"])("label",{for:"due_date"},"到期日",-1),L={class:"mb-3"},I=Object(o["createElementVNode"])("label",{for:"price"},"折扣百分比",-1),P={class:"mb-3"},$={class:"form-check"},T=Object(o["createElementVNode"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),U={class:"modal-footer"},z=Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function A(e,t,n,a,c,l){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",g,[Object(o["createElementVNode"])("div",v,[Object(o["createElementVNode"])("div",N,[Object(o["createElementVNode"])("div",E,[Object(o["createElementVNode"])("h5",V,[n.isNew?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",C,"新增優惠卷")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",y,"編輯優惠卷"))]),k]),Object(o["createElementVNode"])("div",x,[Object(o["createElementVNode"])("div",M,[w,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.tempCoupon.title=e}),placeholder:"請輸入標題"},null,512),[[o["vModelText"],c.tempCoupon.title]])]),Object(o["createElementVNode"])("div",_,[B,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.tempCoupon.code=e}),placeholder:"請輸入優惠碼"},null,512),[[o["vModelText"],c.tempCoupon.code]])]),Object(o["createElementVNode"])("div",D,[S,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.due_date=e})},null,512),[[o["vModelText"],c.due_date]])]),Object(o["createElementVNode"])("div",L,[I,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.tempCoupon.percent=e}),placeholder:"請輸入折扣百分比"},null,512),[[o["vModelText"],c.tempCoupon.percent,void 0,{number:!0}]])]),Object(o["createElementVNode"])("div",P,[Object(o["createElementVNode"])("div",$,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.tempCoupon.is_enabled=e}),id:"is_enabled"},null,512),[[o["vModelCheckbox"],c.tempCoupon.is_enabled]]),T])])]),Object(o["createElementVNode"])("div",U,[z,Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=function(t){return e.$emit("update-coupon",c.tempCoupon)})},Object(o["toDisplayString"])(n.isNew?"新增優惠卷":"更新優惠券"),1)])])])],512)}var R=n("3835"),F=(n("ac1f"),n("1276"),n("e0ae")),G={props:{coupon:{type:Object,default:function(){return{}}},isNew:{type:Boolean,default:!1}},mixins:[F["a"]],emits:["update-coupon"],data:function(){return{tempCoupon:{},due_date:""}},watch:{coupon:function(){this.tempCoupon=this.coupon;var e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T"),t=Object(R["a"])(e,1);this.due_date=t[0]},due_date:function(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}}},J=n("6b0d"),Y=n.n(J);const q=Y()(G,[["render",A]]);var H=q,K=n("6ff1"),Q={data:function(){return{coupons:[],tempCoupon:{},isLoading:!1,isLoadingItem:"",pagination:{},currentPage:1,isNew:!1}},components:{Pagination:f["a"],AdminCouponModal:H,DelModal:K["a"]},methods:{getCoupons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.currentPage=t;var n="".concat("https://vue3-course-api.hexschool.io/v2/","/api/").concat("peter_vue2022","/admin/coupons?page=").concat(t);this.$http.get(n).then((function(t){e.isLoading=!1,e.coupons=t.data.coupons,e.pagination=t.data.pagination})).catch((function(t){e.isLoading=!1,e.$httpMessageState(t.response,"錯誤訊息")}))},updateCoupon:function(e){var t=this;this.isLoadingItem=e.id;var n="".concat("https://vue3-course-api.hexschool.io/v2/","/api/").concat("peter_vue2022","/admin/coupon"),o="post",a=e;this.isNew||(n="".concat("https://vue3-course-api.hexschool.io/v2/","/api/").concat("peter_vue2022","/admin/coupon/").concat(this.tempCoupon.id),o="put"),this.$http[o](n,{data:a}).then((function(e){t.isLoadingItem="",t.$refs.couponModal.hideModal(),t.$httpMessageState(e,"新增優惠券"),t.isNew?t.getCoupons():t.getCoupons(t.currentPage)})).catch((function(e){t.isLoadingItem="",t.$httpMessageState(e.response,"錯誤訊息")}))},deleteCoupon:function(){var e=this;this.isLoadingItem=this.tempCoupon.id;var t="".concat("https://vue3-course-api.hexschool.io/v2/","/api/").concat("peter_vue2022","/admin/coupon/").concat(this.tempCoupon.id);this.$http.delete(t).then((function(t){e.isLoadingItem="",e.$refs.delModal.hideModal(),e.$httpMessageState(t,"刪除優惠券"),e.getCoupons(e.currentPage)})).catch((function(t){e.isLoadingItem="",e.$httpMessageState(t.response,"錯誤訊息")}))},openCouponModal:function(e,t){this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3,is_enabled:0,percent:90,title:"週年慶",code:"A00"}:this.tempCoupon=Object(O["a"])({},t),this.$refs.couponModal.openModal()},openDelCouponModal:function(e){this.tempCoupon=Object(O["a"])({},e),this.$refs.delModal.openModal()}},mounted:function(){this.getCoupons()}};const W=Y()(Q,[["render",j]]);t["default"]=W},3835:function(e,t,n){"use strict";function o(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function a(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,c=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(o=n.next()).done);l=!0)if(c.push(o.value),t&&c.length===t)break}catch(r){i=!0,a=r}finally{try{l||null==n["return"]||n["return"]()}finally{if(i)throw a}}return c}}var c=n("06c5");n("d9e2");function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){return o(e)||a(e,t)||Object(c["a"])(e,t)||l()}},"44e7":function(e,t,n){var o=n("861d"),a=n("c6b6"),c=n("b622"),l=c("match");e.exports=function(e){var t;return o(e)&&(void 0!==(t=e[l])?!!t:"RegExp"==a(e))}},"6ff1":function(e,t,n){"use strict";var o=n("7a23"),a={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},c={class:"modal-dialog",role:"document"},l={class:"modal-content border-0"},i={class:"modal-header bg-danger text-white"},r={class:"modal-title"},d=Object(o["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),s={class:"modal-body"},u=Object(o["createTextVNode"])(" 是否刪除 "),p={class:"text-danger"},b=Object(o["createTextVNode"])(" (刪除後將無法恢復)。 "),m={class:"modal-footer"},h=Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function j(e,t,n,j,O,f){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",a,[Object(o["createElementVNode"])("div",c,[Object(o["createElementVNode"])("div",l,[Object(o["createElementVNode"])("div",i,[Object(o["createElementVNode"])("h5",r,[Object(o["createElementVNode"])("span",null,"刪除"+Object(o["toDisplayString"])(n.title),1)]),d]),Object(o["createElementVNode"])("div",s,[u,Object(o["createElementVNode"])("strong",p,Object(o["toDisplayString"])(n.content),1),b]),Object(o["createElementVNode"])("div",m,[h,Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=function(t){return e.$emit("del-item")})},"確認刪除")])])])],512)}var O=n("e0ae"),f={props:{item:{type:Object,default:function(){return{}}},title:{type:String,default:""},content:{type:String,default:""}},emits:["del-item"],mixins:[O["a"]]},g=n("6b0d"),v=n.n(g);const N=v()(f,[["render",j]]);t["a"]=N},ca8d:function(e,t,n){"use strict";var o=n("7a23"),a={"aria-label":"Page navigation example"},c={class:"pagination justify-content-center"},l=Object(o["createElementVNode"])("span",{"aria-hidden":"true"},"«",-1),i=[l],r=["onClick"],d=Object(o["createElementVNode"])("span",{"aria-hidden":"true"},"»",-1),s=[d];function u(e,t,n,l,d,u){return Object(o["openBlock"])(),Object(o["createElementBlock"])("nav",a,[Object(o["createElementVNode"])("ul",c,[Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])(["page-item",{disabled:!n.pagination.has_pre}])},[Object(o["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=Object(o["withModifiers"])((function(e){return u.getProduct(n.pagination.current_page-1)}),["prevent"]))},i)],2),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(n.pagination.total_pages,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:Object(o["normalizeClass"])(["page-item",{active:e===n.pagination.current_page}]),key:"page"+e},[Object(o["createElementVNode"])("a",{class:"page-link",href:"#",onClick:Object(o["withModifiers"])((function(t){return u.getProduct(e)}),["prevent"])},Object(o["toDisplayString"])(e),9,r)],2)})),128)),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])(["page-item",{disabled:!n.pagination.has_next}])},[Object(o["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=Object(o["withModifiers"])((function(e){return u.getProduct(n.pagination.current_page+1)}),["prevent"]))},s)],2)])])}var p={props:{pagination:{type:Object,default:function(){return{}}}},emits:["get-products"],methods:{getProduct:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$emit("get-products",e)}}},b=n("6b0d"),m=n.n(b);const h=m()(p,[["render",u]]);t["a"]=h}}]);
//# sourceMappingURL=chunk-00a2a525.8c1ae198.js.map